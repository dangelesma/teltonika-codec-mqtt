version: '3.8'
services:
  teltonika-server:
    build: .
    image: ${DOCKER_IMAGE:-teltonika-codec-mqtt:latest}
    container_name: teltonika-codec-server
    restart: unless-stopped
    ports:
      - "${udpServerOptions__port:-8833}:8833"
      - "${WEB_API_PORT:-3000}:3000"
    environment:
      - NODE_ENV=${NODE_ENV:-production}
      - WEB_API_PORT=${WEB_API_PORT:-3000}
      - WEB_API_HOST=0.0.0.0
      - mqttOptions__host=${mqttOptions__host:-localhost}
      - mqttOptions__port=${mqttOptions__port:-1883}
      - mqttOptions__protocol=${mqttOptions__protocol:-mqtt}
      - orOpts__commandTopic=${orOpts__commandTopic:-commands}
      - orOpts__dataTopic=${orOpts__dataTopic:-data}
      - orOpts__realm=${orOpts__realm:-master}
      - orOpts__teltonika_keyword=${orOpts__teltonika_keyword:-teltonika}
      - udpServerOptions__port=8833
    networks:
      - teltonika-net

networks:
  teltonika-net:
    driver: bridge